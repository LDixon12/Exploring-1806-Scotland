<!DOCTYPE html>
<html>

<head>
  <title>Exploring 1806 Scotland</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
    integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
    crossorigin="" />
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    h2 {
            font-family: 'Palantino', cursive;
            font-weight: 300;
            color: #ffffff;
            font-size: 3em;
            letter-spacing: .06em;
            margin: 0 0 25px 0;
        }
        p {
			font-size: .8em;
			line-height: 1.5em;
            color:#ffffff
		}   
    h3 {
			font-size: 1.5em;
			line-height: 1.5em;
            color:#ffffff
		}   

    p img {
      float: left;
      padding: 0 12px 12px 0;
    }
    #place-info {
			font-size: 1em;
			line-height: 1.5em;
            color:#ffffff
		} 

    #map {
      position: absolute;
      width: 60%;
      top: 0;
      bottom: 0;
    }

    #info-panel {
      position: absolute;
      width: 37%;
      top: 0;
      bottom: 0;
      right: 0;
      background-color: #0065bf;
      padding: 12px 18px 3%;
    }

    #ui {
      padding: 8px 12px;
    }

    button {
      width: 20%;
    }

    #btn-back {
      margin-right: 12px;
    }
  </style>
</head>

<body>
  <div id="map"></div>
  <div id="info-panel">
    <h2>Exploring 1806 Scotland</h2>
    <div id="ui">
      <button id="btn-back">
        << back</button><button id="btn-forward">forward >></button>
    </div>
    <div id="place-info">
      In this exploration we are going to look at a Western Scotland and Shetland Ilse map as well as an Eastern Scotland map both published by C. Smith in 1806. These maps are part of a larger series called New Map of Great Britain and Ireland series. 
      <br>
      <br>
      We will investigate the symbology, text, and techniques used by C. Smith in the creation of these maps to create a narrative of what makes this map a map.
      <br>
      <br>
      Lets get exploring!
    </div>

  </div>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
    crossorigin=""></script>
  <!-- make sure to import Leaflet-IIIF *after* the main Leaflet package -->
  <script src="https://cdn.rawgit.com/mejackreed/Leaflet-IIIF/v3.0.0/leaflet-iiif.js"></script>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

  <script>
    // instantite Leaflet map
    const map = L.map("map", {
      center: [0, 0],
      crs: L.CRS.Simple,
      zoom: 0,
    });

    // request IIIF layer and add to map
    const scotlandLayer = new L.tileLayer.iiif(
      "https://maps.nls.uk/view/216442400/manifest.json"
    ).addTo(map);

    // select the side panel div to insert info into later
    const placeInfo = $('#place-info');

    // select the UI elements and reference with variables
    const backButton = $('#btn-back');
    const forwardButton = $('#btn-forward');

    // use this to determine mouse position
    // can then use coords to create markers, etc.
    map.on('mousemove', (e) => {
      // console.log(e.latlng)
    })

    // here we'll create markers for key places in the story
    const legend = L.marker([-280, 511]).addTo(map);
    const ocean = L.marker([-280, 258]).addTo(map);
    const river = L.marker([-280, 258]).addTo(map);
    const land = L.marker([-156, 638]).addTo(map);
    const labels = L.marker([-156, 638]).addTo(map);

    // can use template strings for organizing text content

    // construct text string to be inserted into DOM
    const legendHtml = `<h3>Interperting the legend!</h3><p>While our legend doesn't have the maps symbology protrayed and described, it does give a list of the features on the map.
                        <br>
                        <br>
                        "Smith's New Map of the United Kingdom of Great Britian and Ireland on 
                         which the turnpike and principal cross roads are carefully described.
                         Particularly distinguishing the route of the mail coaches, the course of the rivers, and navigable canals:
                         the cities, market towns, and most considerable villages,
                         specifying the distance from London to every principle town likewise the distance from one market town to another. 
                         The whole drawn from the best authorities assisted by local information." 
                         <br>
                         <br>
                         It is important to notice the changing of font and size between each line. We can interpert this as a form of hierarchy, the more important features being in larger, bolder font while the less important are in a smaller font. This also adds a florish and artistry to the legend that can make some of the fonts difficult to read. 
                          </p>`

    const oceanHtml = `<h3>Lets take a dive!</h3><p></p>`

    const riverHtml = `<h3>Lets take a dive continued!</h3><p></p>`;

    const landHtml = `<h3>Land ho!</h3><p></p>`;

    const labelsHtml = `<h3>Read me!</h3><p></p>`;

    const extrasHtml = `<h3>Extras!</h3><p></p>`;

    // function to be called when both clicking on marker and
    // when using UI buttons to move fowward and back
    function triggerLegend() {
      // replace exisiting HTML content in the side panel
      placeInfo.html(legendHtml);
      // fly the map to that location
      map.flyTo(legend.getLatLng(), 3);
    }

    function triggerOcean() {
      placeInfo.html(oceanHtml);
      map.flyTo(ocean.getLatLng(), 3);
    }

    function triggerRiver() {
      placeInfo.html(riverHtml);
      map.flyTo(river.getLatLng(), 3);
    }

    function triggerLand() {
      placeInfo.html(landHtml);
      map.flyTo(land.getLatLng(), 3);
    }

    function triggerLabels() {
      placeInfo.html(labelsHtml);
      map.flyTo(labels.getLatLng(), 3);
    }

    function triggerExtras() {
      placeInfo.html(extrasHtml);
    }

    // on marker click, trigger Legend event
    legend.on('click', () => {
      triggerLegend();
    });

    ocean.on('click', () => {
      triggerOcean();
    });


    // use a list to dictate order of story
    const story = ['legend', 'ocean', 'river', 'land', 'labels', 'extras'];

    // counter to keep track of where in story the user is
    let counter = 0;

    // object mapping the name of the places in the story
    // to the function to be triggered
    const storyMap = {
      legend: triggerLegend,
      ocean: triggerOcean,
      river: triggerRiver,
      land: triggerLand,
      labels: triggerLabels,
      extras: triggerExtras,
    }

    // forward button increments counter and calls appropriate trigger function
    forwardButton.on('click', () => {
      console.log('before: counter: ', counter, 'object: ', story[counter]);
      if (counter < story.length) {
        storyMap[story[counter]]();
      }
      if (counter < story.length - 1) {
        counter++;
      }
      console.log('after: counter:', counter, 'object: ', story[counter]);
    });

    // backward button decreases value of counter and calls appropriate trigger function
    backButton.on('click', () => {
      console.log('before: counter: ', counter, 'object: ', story[counter]);
      if (counter > 0) {
        counter--;
        storyMap[story[counter]]();
      }
      console.log('after: counter: ', counter, 'object: ', story[counter]);
    });



  </script>
</body>

</html>